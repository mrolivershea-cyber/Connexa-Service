════════════════════════════════════════════════════════════════════════════════
  CONNEXA v7.0 - СПИСОК ИЗМЕНЕНИЙ (CHANGELOG)
════════════════════════════════════════════════════════════════════════════════

📅 Дата релиза: 05.11.2025
🔖 Версия: 7.0 FINAL

════════════════════════════════════════════════════════════════════════════════

🆕 НОВЫЕ ВОЗМОЖНОСТИ:

  ✅ Координаты (широта/долгота)
     • Автоматическое получение координат при тестах ГЕО/Фрауд/ГЕО+Фрауд
     • API: ip-api.com (бесплатный, без ключа)
     • Формат: "latitude,longitude" (например: "33.8308,-118.1125")
     • Новая колонка "Координаты" в таблице узлов
     • Копирование координат одним кликом
     
  ✅ Цветовая схема Risk Level
     • LOW: 🟢 Зеленый
     • MEDIUM: 🟡 Желтый
     • HIGH: 🟠 Оранжевый
     • CRITICAL: 🔴 Красный

════════════════════════════════════════════════════════════════════════════════

🔧 ИСПРАВЛЕНИЯ:

  ✅ Тесты ГЕО/Фрауд/ГЕО+Фрауд
     • ИСПРАВЛЕНО: "0 успешно" → теперь показывает реальные результаты
     • ИСПРАВЛЕНО: Background tasks через threading (надежнее)
     • ИСПРАВЛЕНО: Результаты сохраняются в progress_store
     
  ✅ Копирование PPTP учетных данных
     • БЫЛО: "71.84.237.32:admin:admin" (с двоеточиями)
     • СТАЛО: "71.84.237.32 admin admin" (с пробелами)

════════════════════════════════════════════════════════════════════════════════

🧹 ОПТИМИЗАЦИЯ:

  ✅ Очистка кода
     • Удалено 150+ мусорных файлов
     • Удалены тестовые скрипты (test_*.py, debug_*.py)
     • Удалены backup файлы (*.backup)
     • Удалена документация разработки (50+ .md/.txt файлов)
     • Очищен Python cache (__pycache__)
     • Освобождено: ~8MB

════════════════════════════════════════════════════════════════════════════════

📦 ИЗМЕНЕНИЯ В БД:

  ✅ Новое поле в таблице nodes:
     • coordinates VARCHAR(50) - хранит "latitude,longitude"

════════════════════════════════════════════════════════════════════════════════

🔄 ТЕХНИЧЕСКИЕ ДЕТАЛИ:

  Backend:
    • database.py: добавлено поле coordinates
    • ip_geolocation.py: добавлено получение lat/lon
    • service_manager_geo.py: координаты во всех 3 тестах
    • server.py: исправлен запуск background tasks через threading
    
  Frontend:
    • NodesTable.js: новая колонка "Координаты" с кнопкой копирования
    • NodesTable.js: цветовая схема для Risk Level
    • NodesTable.js: копирование PPTP с пробелами

════════════════════════════════════════════════════════════════════════════════

📝 МИГРАЦИЯ С v6.0:

  Для обновления существующей установки:
  
  1. Сделайте backup базы данных:
     cp /app/backend/connexa.db /root/connexa.db.backup
  
  2. Остановите сервисы:
     sudo supervisorctl stop all
  
  3. Обновите код:
     cd /app
     git pull
  
  4. Добавьте новое поле в базу:
     cd /app/backend
     python3 << 'EOF'
from sqlalchemy import create_engine, text
engine = create_engine('sqlite:///./connexa.db')
with engine.connect() as conn:
    conn.execute(text("ALTER TABLE nodes ADD COLUMN coordinates VARCHAR(50) DEFAULT NULL"))
    conn.commit()
print("✅ База обновлена")
EOF
  
  5. Перезапустите:
     sudo supervisorctl restart all

════════════════════════════════════════════════════════════════════════════════

🎯 ТЕСТИРОВАНИЕ ПОСЛЕ УСТАНОВКИ:

  1. Откройте http://YOUR_IP:3000
  2. Войдите: admin / admin
  3. Импортируйте тестовые узлы
  4. Запустите Testing Modal:
     • GEO Test - проверьте координаты в таблице
     • Fraud Test - проверьте координаты + fraud score
     • GEO+Fraud - проверьте полные данные
  5. Проверьте цвета в колонке Risk Level
  6. Скопируйте учетные данные - должны быть с пробелами

════════════════════════════════════════════════════════════════════════════════

Версия 7.0 - Final Release
